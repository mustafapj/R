import telebot
import time
import threading
import socket
import socks

# ุฅุนุฏุงุฏ Tor
socks.set_default_proxy(socks.SOCKS5, "127.0.0.1", 9050)
socket.socket = socks.socksocket

TOKEN = "8520375677:AAGcmKBcCOKsaLcHPHvbiBjSP-rmRU48cOY"
bot = telebot.TeleBot(TOKEN)

class ArayBot:
    def __init__(self):
        self.is_active = False
        self.words = [
  "ูุฑุญุจุง",
  "ููุง ุจููู",
  "ุดููููู ุญุจุงูุจู",
  "ุดูููู ุงูุช",
  "ุงูุณูุงู ุนูููู",
  "ููุง ุดูู ุงูุฃุฎุจุงุฑ",
  "ููู ูุณุงุนุฏูู ูู ุณูุญุชูุง",
  "ุฃุญุชุงุฌ ูุณุงุนุฏุฉ ุถุฑูุฑู",
  "ูููู ุฃุญุฏ ูููุฏูู",
  "ุฃุญุฏ ูุฌุงูุจูู ูู ุณูุญุชูุง",
  "ุฃุฑูุฏ ุฃุณุฃู ุณุคุงู",
  "ุฃุฑูุฏ ุชุจููุช ุฅุฐุง ูููู",
  "ุฃุญุชุงุฌ ุฏุนู ุจุณูุท",
  "ุชูุฏุฑูู ุชุณุงุนุฏููู",
  "ูููุช ุงูููู",
  "ููุด ุถูุฌุฉ",
  "ุญุงุณูุฉ ููู",
  "ูุฎูููุฉ ุดูู",
  "ุถุงูุฌุฉ ููุด",
  "ุทูุดุงูุฉ",
  "ุฒููุงูุฉ",
  "ุชุนุจุงูุฉ ููุณูุงู",
  "ุญุงุณูุฉ ุฅุญุจุงุท",
  "ุฏูุฎุฉ ุฎูู",
  "ูุง ุนูุฏู ุฎูู ูุดู",
  "ุถุงูุฌ ุฎููู",
  "ูุงุญุฏุฉ ุชุญุฌู ููุงู",
  "ุฃุฑูุฏ ุฃุญุฏ ูููุณูู",
  "ุฃุฑูุฏ ุณูุงูู",
  "ูุฏ ูุญุฏุฉ ูุงุถูุฉ",
  "ุฃูุทููู ุฑุฃููู",
  "ููู ููุฌูุฏ",
  "ููุง ุดูู ูุงูู",
  "ุฃุฑูุฏ ุฃุญุฌู ููุง ุฃุญุฏ",
  "ุฃุญุชุงุฌ ูุตูุญุฉ",
  "ููู ุนูุฏู ุฎุจุฑุฉ ูููุฏูู",
  "ุฃุญุฏ ูุฑุฏ ุนููู",
  "ุณุคุงู ุจุณูุท ุจุณ ูุญุชุงุฑุฉ",
  "ุชูุฏุฑูู ุชุฌุงูุจููู",
  "ุฃุฑูุฏ ูุนูููุงุช ุนู ุดู",
  "ูุญุชุงุฌุฉ ุงุญุฏ ูููููู",
  "ุญุงุณูุฉ ูุง ูุฑุชุงุญุฉ",
  "ูุฒุงุฌู ุตูุฑ",
  "ูุงููู ุถุฌุช",
  "ุตุงุฑูู ุณุงุนุฉ ูููุช",
  "ุฃุฑูุฏ ุฃุบูุฑ ุฌู",
  "ูุฏ ุดู ูููุณ",
  "ูุง ุฃุนุฑู ุดุณูู",
  "ุฃุฑูุฏ ุฃุดุบู ููุณู ุจุดู",
  "ุฃุฑูุฏ ูุงุญุฏู ุชูุตุญูู",
  "ุฃุฑูุฏ ุฃุณููู",
  "ูููู ุงูุจูุงุช",
  "ููู ูุงุถูุฉ ุชุญุฌู ููุงู",
  "ุฃุฑูุฏ ุฃูุถูุถ",
  "ุฏุง ุฃูู ุจุตุฑุงุญุฉ",
  "ุฃุฑูุฏ ุฃุญุฏ ูุณูุนูู",
  "ุญุงุณูุฉ ุจูุญุฏุฉ",
  "ููุฑูุจุฉ ุงูููู",
  "ููุงู ุถุบุท",
  "ูุญุชุงุฌุชูู",
  "ุณุงุนุฏููู ุฅุฐุง ุชูุฏุฑูู",
  "ุดูู ุชูุตุญููู ุฃุณูู",
  "ุฃุญุฏ ููุทููู ุญู",
  "ุญุงุณุฉ ููุชู ุถุงูุน",
  "ุงูููู ูู ูููู",
  "ูุฒุงุฌู ูู ุฒูู",
  "ุชูุนุจ ููุณู ุฃุทูุน",
  "ุฃุฑูุฏ ุฃุณููู ูู ุถูุฌุชู",
  "ุฃุฑูุฏ ุฃุชูุงูู ููุง ุฃุญุฏ",
  "ุจูุงุช ุดูู ุฑุฃููู",
  "ุฃุฑูุฏ ุฑุฃู ุตุฑูุญ",
  "ุฃุฑูุฏ ูุดุงุฑูุฉ ุจุณูุทุฉ",
  "ุชุนุงููุง ูุณููู",
  "ุฃุญุฏ ููุชุฑุญูู ุดู",
  "ุฃุฑูุฏ ููุถูุน ูุญุฌู ุจูู",
  "ููุด ูุญุชุงุฑุฉ",
  "ุฃุฑูุฏ ุฃูุถูุถ ุดูู",
  "ุญุงุณูุฉ ููุณู ูุถุบูุทุฉ",
  "ุฃุฑูุฏ ุฃุฑุชุงุญ ููุณูุงู",
  "ุฃุญุชุงุฌ ููุงู ุญูู",
  "ุฃุฑูุฏ ุชุดุฌูุน",
  "ุญุงุณูุฉ ุฃูู ุถุงูุนุฉ",
  "ุฃุฑูุฏ ุฃุฑูุฒ ุจุณ ูุง ุฃูุฏุฑ",
  "ูุฎู ูุฒุฏูุฏ",
  "ุฃุฑูุฏ ุฃุญุฏ ูููู ุดุนูุฑู",
  "ุญุงุณูุฉ ุฅูู ูุญุชุงุฌุฉ ุฃุญุฏ ูุญุฌู ููุงู",
  "ุฃุฑูุฏ ุชูููู",
  "ุฃุฑูุฏ ุฃุญุฏ ูุนุทููู ุฏูุนุฉ",
  "ุงูููู ุซููู ููุด",
  "ูุงูุฏุฉ ุญูุงุณ",
  "ุฃุฑูุฏ ูููุชูู ุจุณ ุชุฑูุญูู",
  "ุญุงุณุฉ ูู ุจููููู",
  "ุฃุฑูุฏ ุฃุชููุณ ููุงูู",
  "ููุง ุจููู ุดูู ุงูุณุงููุฉ",
  "ุฃุฑูุฏ ุฃุญุฌู ุดูู",
  "ุฃุฑูุฏ ุฃุญุฏ ูููููู ุจุณุฑุนู",
  "ุตุงุฑูู ุถุงูุฌุฉ ูู ุงูุตุจุญ",
  "ุฃุฑูุฏ ุดู ูุบูุฑ ูุฒุงุฌู",
  "ูุญุชุงุฌุฉ ูุฌูุฏูู"
]
        self.current_index = 0
        self.group_chat_id = None
        
    def start_sending(self, group_chat_id):
        """ุจุฏุก ุฅุฑุณุงู ุงููููุงุช ูู ุงููุฌููุนุฉ"""
        if self.is_active:
            return "โณ ุงูุจูุช ูุนูู ุจุงููุนู!"
        
        self.is_active = True
        self.group_chat_id = group_chat_id
        self.current_index = 0
        
        # ุฅุฑุณุงู ุฑุณุงูุฉ ุงูุจุฏุก ูู ุงููุฌููุนุฉ
        try:
            bot.send_message(group_chat_id, "๐ ุจุฏุฃ ุงูุจูุช")
        except Exception as e:
            print(f"ุฎุทุฃ ูู ุงูุฅุฑุณุงู: {e}")
        
        # ุจุฏุก ุงูุฅุฑุณุงู ูู thread ูููุตู
        thread = threading.Thread(target=self._sending_loop)
        thread.daemon = True
        thread.start()
        
        return "ุจุฏุฃ ุงูุจูุช ุงูุนูู ๐"
    
    def stop_sending(self, group_chat_id):
        """ุฅููุงู ุฅุฑุณุงู ุงููููุงุช"""
        if not self.is_active:
            return "ุงูุจูุช ูุชููู ุจุงููุนู!"
        
        self.is_active = False
        try:
            bot.send_message(group_chat_id, "โน๏ธ ุชููู ุงูุจูุช")
        except Exception as e:
            print(f"ุฎุทุฃ ูู ุงูุฅุฑุณุงู: {e}")
        return " ูุตูุช ุญุจู ุณูุชูู๐"
    
    def _sending_loop(self):
        """ุญููุฉ ุงูุฅุฑุณุงู ุงูุฑุฆูุณูุฉ ูู ุงููุฌููุนุฉ"""
        while self.is_active:
            try:
                # ุงูุญุตูู ุนูู ุงููููุฉ ุงูุญุงููุฉ
                word = self.words[self.current_index]
                
                # ุฅุฑุณุงู ุงููููุฉ ูู ุงููุฌููุนุฉ ุจุฏูู ุฃู ุฅุถุงูุงุช
                bot.send_message(self.group_chat_id, word)
                print(f"โ ุชู ุฅุฑุณุงู ูู ุงููุฌููุนุฉ: {word}")
                
                # ุงูุงูุชูุงู ูููููุฉ ุงูุชุงููุฉ
                self.current_index = (self.current_index + 1) % len(self.words)
                
                # ุงูุชุธุงุฑ 15 ุซุงููุฉ
                for i in range(60):
                    if not self.is_active:
                        break
                    time.sleep(1)
                    
            except Exception as e:
                print(f"โ ุฎุทุฃ ูู ุงูุฅุฑุณุงู: {e}")
                time.sleep(15)

# ูุงุฆู ุงูุจูุช
aray_bot = ArayBot()

@bot.message_handler(commands=['start'])
def start(message):
    """ุฑุณุงูุฉ ุงูุชุฑุญูุจ"""
    welcome = """
๐ฏ ุจูุช ุฃุฑุงู ูููููุงุช

๐ ุทุฑููุฉ ุงูุงุณุชุฎุฏุงู ูู ุงููุฌููุนุฉ:
โข ุงุฑุงููข - ุจุฏุก ุฅุฑุณุงู ุงููููุงุช
โข ุงุฑุงู - ุฅููู ุงูุจูุช

๐ ุงููุธููุฉ:
โข ูุฑุณู ูููุงุช (ูุชุ ููุ ูุ ุบ) ูู ุงููุฌููุนุฉ
โข ูู 15 ุซุงููุฉ ูููุฉ ุฌุฏูุฏุฉ
โข ุจุฏูู ุฃู ุฅุถุงูุงุช ุฃู ุฑููุฒ
"""
    bot.send_message(message.chat.id, welcome)

@bot.message_handler(func=lambda message: True)
def handle_all_messages(message):
    """ูุนุงูุฌุฉ ุฌููุน ุงูุฑุณุงุฆู"""
    text = message.text.strip()
    chat_type = message.chat.type
    
    try:
        if text == "ุงุฑุงู":
            # ุจุฏุก ุงูุจูุช ูู ุงููุฌููุนุฉ
            if chat_type == "group" or chat_type == "supergroup":
                result = aray_bot.start_sending(message.chat.id)
                bot.reply_to(message, result)
            else:
                bot.reply_to(message, "โ๏ธ ูุฐุง ุงูุฃูุฑ ูุนูู ูู ุงููุฌููุนุงุช ููุท!")
        
        elif text == "ุงุฑุงููข":
            # ุฅููุงู ุงูุจูุช ูู ุงููุฌููุนุฉ
            if chat_type == "group" or chat_type == "supergroup":
                result = aray_bot.stop_sending(message.chat.id)
                bot.reply_to(message, result)
            else:
                bot.reply_to(message, "โ๏ธ ูุฐุง ุงูุฃูุฑ ูุนูู ูู ุงููุฌููุนุงุช ููุท!")
        
        elif chat_type == "private":
            bot.reply_to(message, "โ ุฃุถู ุงูุจูุช ูููุฌููุนุฉ ุซู ุงูุชุจ 'ุงุฑุงููข'")
            
    except Exception as e:
        print(f"โ ุฎุทุฃ ูู ูุนุงูุฌุฉ ุงูุฑุณุงูุฉ: {e}")

@bot.message_handler(content_types=['new_chat_members'])
def welcome_new_members(message):
    """ุชุฑุญูุจ ุจุงูุฃุนุถุงุก ุงูุฌุฏุฏ"""
    try:
        for member in message.new_chat_members:
            if member.is_bot and member.username == bot.get_me().username:
                welcome_msg = "๐ฏ ุจูุช ุฃุฑุงู ูููููุงุช\n\nุงูุชุจ 'ุงุฑุงููข' ูุจุฏุก ุงูุนูู"
                bot.send_message(message.chat.id, welcome_msg)
                break
    except Exception as e:
        print(f"โ ุฎุทุฃ ูู ุชุฑุญูุจ ุงูุฃุนุถุงุก: {e}")

if __name__ == "__main__":
    print("๐ ุจุฏุก ุชุดุบูู ุจูุช ุฃุฑุงู ุนุจุฑ Tor...")
    try:
        bot.polling(none_stop=True)
    except Exception as e:
        print(f"โ ุฎุทุฃ ูู ุชุดุบูู ุงูุจูุช: {e}")